-extends "base.haml"
-set page="Instances"

-block head
	%script(type="application/javascript" src="/static/instance.js" nonce="{{view.request['hash']}}")

-block content
	%details.section
		%summary << Add Instance
		#add-item
			%label(for="new-actor") << Actor
			%input(type="url" id="new-actor" placeholder="Actor URL")

			%label(for="new-inbox") << Inbox
			%input(type="url" id="new-inbox" placeholder="Inbox URL")

			%label(for="new-followid") << Follow ID
			%input(type="url" id="new-followid" placeholder="Follow ID URL")

			%label(for="new-software") << Software
			%input(id="new-software" placeholder="software")

		%input(type="button" value="Add Instance", onclick="add_instance()")

	-if requests
		%fieldset.section.requests
			%legend << Follow Requests
			.data-table
				%table#requests
					%thead
						%tr
							%td.instance << Instance
							%td.software << Software
							%td.date << Joined
							%td.approve
							%td.deny

					%tbody
						-for request in requests
							%tr(id="{{request.domain}}")
								%td.instance
									%a(href="https://{{request.domain}}" target="_new") -> =request.domain

								%td.software
									=request.software or "n/a"

								%td.date
									=request.created.strftime("%Y-%m-%d")

								%td.approve
									%a(href="#" onclick="req_response('{{request.domain}}', true)" title="Approve Request") << &check;
									
								%td.deny
									%a(href="#" onclick="req_response('{{request.domain}}', false)" title="Deny Request") << &#10006;

	%fieldset.section.instances
		%legend << Instances

		.data-table
			%table#instances
				%thead
					%tr
						%td.instance << Instance
						%td.software << Software
						%td.date << Joined
						%td.remove

				%tbody
					-for instance in instances
						%tr(id="{{instance.domain}}")
							%td.instance
								%a(href="https://{{instance.domain}}/" target="_new") -> =instance.domain

							%td.software
								=instance.software or "n/a"

							%td.date
								=instance.created.strftime("%Y-%m-%d")

							%td.remove
								%a(href="#" onclick="del_instance('{{instance.domain}}')" title="Remove Instance") << &#10006;
